<script type="module">
// =================================================================
// KONFIGURASI FRONTEND
// =================================================================
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxqZtFZ5025PKt547C105ctC697OZlxvtFX9URDCt4zisAMLv_SuXSSFudtrlXatSVm/exec';

// =================================================================
// FILE: services/api.ts (VERSI FETCH API)
// =================================================================

// Helper untuk memanggil backend Apps Script menggunakan fetch
const apiCall = async (functionName, ...args) => {
    const response = await fetch(APPS_SCRIPT_URL, {
        method: 'POST',
        headers: {
            'Content-Type': 'text/plain;charset=utf-8', // Diperlukan oleh Apps Script
        },
        body: JSON.stringify({ functionName, args }),
        // 'mode: no-cors' akan menyebabkan error, biarkan default (cors)
    });

    if (!response.ok) {
        throw new Error(`Network response was not ok: ${response.statusText}`);
    }

    const result = await response.json();
    
    if (result.error) {
       throw new Error(result.error);
    }

    return result;
};

// Implementasi API menggunakan fetch
export const api = {
    ping: () => apiCall('ping'),
    login: (email, password) => apiCall('login', email, password),
    logout: () => apiCall('logout'),
    checkAuth: () => apiCall('checkAuth'),
    getDashboardStats: () => apiCall('getDashboardStats'),
    listSurat: (type, filters) => apiCall('listSurat', type, filters),
    createSurat: (type, data) => apiCall('createSurat', type, data),
    updateSurat: (type, id, data) => apiCall('updateSurat', type, id, data),
    deleteSurat: (type, id) => apiCall('deleteSurat', type, id),
    getNewNomorSurat: () => apiCall('getNewNomorSurat'),
    updateUserProfile: (data) => apiCall('updateUserProfile', data),
};


// =================================================================
// SEMUA KODE REACT/TSX ANDA DIMULAI DARI SINI
// (Untuk singkatnya, ini hanya men-impor App.tsx dari URL,
// namun dalam bundel nyata, semua kode akan ada di sini)
// =================================================================
import React from "https://esm.sh/react@18.2.0";
import ReactDOM from "https://esm.sh/react-dom@18.2.0/client";

// Impor semua komponen Anda
// Dalam proses build nyata, ini tidak akan menjadi URL
// Ini hanya untuk menyederhanakan demo ini
import App from './App.tsx';

// Polyfill
if (typeof global === 'undefined') {
  window.global = window;
}

const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Could not find root element to mount to");
}

const root = ReactDOM.createRoot(rootElement);
root.render(
  React.createElement(React.StrictMode, null, React.createElement(App))
);

</script>
<script type="module" src="./index.tsx"></script>
